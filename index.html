<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LADY LEGALZ BETA 4 || CONTRACTGEN BETA v3.8.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --bg: #010508;
            --neon-teal: #00ff9d;
            --neon-cyan: #00f2ff;
            --neon-purple: #bd00ff;
            --neon-pink: #ff00b3;
            --alert-red: #ff003c;
            --gold: #c5a059;
            --glass: rgba(5, 12, 18, 0.96);
            --panel-border: rgba(0, 255, 157, 0.2);
        }
        @keyframes pulse-red {
            0% { box-shadow: 0 0 15px var(--alert-red); border-color: var(--alert-red); }
            50% { box-shadow: 0 0 35px var(--alert-red); border-color: #fff; }
            100% { box-shadow: 0 0 15px var(--alert-red); border-color: var(--alert-red); }
        }
        .neural-alert { animation: pulse-red 0.8s infinite !important; }
        #boot-screen {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            font-family: 'Share Tech Mono', monospace; color: var(--neon-teal);
            transition: opacity 1.5s ease;
        }
        .boot-loader { width: 300px; border: 1px solid #111; height: 2px; margin-top: 25px; }
        .boot-progress { width: 0%; height: 100%; background: var(--neon-teal); box-shadow: 0 0 20px var(--neon-teal); transition: width 0.2s; }
        * { box-sizing: border-box; }
        #matrix-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.1; pointer-events: none; z-index: 1; }
        body, html { margin: 0; padding: 0; height: 100vh; width: 100vw; background: #000; color: #e0e6ed; font-family: 'Rajdhani', sans-serif; overflow: hidden; }
        .container {
            width: 100vw; height: 100vh; border: 1px solid var(--panel-border);
            background: var(--glass); backdrop-filter: blur(40px); display: flex; flex-direction: column; padding: 15px;
            position: relative; z-index: 10;
        }
        .header { text-align: center; padding: 10px; border-bottom: 1px solid var(--panel-border); margin-bottom: 10px; }
        .header h1 { font-family: 'Orbitron'; letter-spacing: 12px; margin: 0; font-size: 1.4rem; color: #fff; text-shadow: 0 0 10px var(--neon-teal); }
        .main-workspace { display: grid; grid-template-columns: 320px 1fr 320px; gap: 15px; flex: 1; min-height: 0; }
        .side-panel { background: rgba(0,0,0,0.6); border: 1px solid var(--panel-border); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; overflow-y: auto; }
        .center-vault { position: relative; border-radius: 12px; background: rgba(0,0,0,0.5); border: 1px solid rgba(0, 242, 255, 0.15); display: flex; flex-direction: column; overflow: hidden; }
        textarea { flex: 1; background: transparent; border: none; padding: 25px; color: #fff; font-family: 'Share Tech Mono'; font-size: 0.85rem; outline: none; resize: none; line-height: 1.7; z-index: 5; }
        #pdf-frame { width: 100%; height: 100%; border: none; display: none; background: #fff; z-index: 6; }
        .label { font-size: 0.65rem; color: var(--gold); letter-spacing: 2.5px; margin: 18px 0 6px 4px; font-weight: 700; text-transform: uppercase; }
        select, input { background: #080808; border: 1px solid var(--panel-border); color: var(--neon-teal); padding: 11px; border-radius: 4px; font-family: 'Share Tech Mono'; width: 100%; margin-bottom: 10px; outline: none; font-size: 0.75rem; }
        .sig-box { background: #fff; border-radius: 4px; width: 100%; height: 90px; touch-action: none; cursor: crosshair; }
        .btn { border-radius: 4px; padding: 12px; cursor: pointer; font-family: 'Orbitron'; font-size: 0.65rem; border: none; text-transform: uppercase; font-weight: bold; width: 100%; margin-bottom: 10px; transition: 0.3s; }
        .btn:hover { filter: brightness(1.2); }
        .btn-generate { background: linear-gradient(90deg, var(--neon-teal), var(--neon-cyan)); color: #000; }
        .history-item { background: rgba(255,255,255,0.05); border: 1px solid var(--panel-border); padding: 8px; border-radius: 4px; margin-bottom: 8px; cursor: pointer; font-size: 0.65rem; }
        .history-item:hover { border-color: var(--neon-teal); background: rgba(0, 255, 157, 0.1); }
        .history-item .date { color: var(--neon-cyan); font-size: 0.55rem; }
        .evidence-dropzone { border: 1px dashed var(--neon-cyan); padding: 10px; text-align: center; font-size: 0.6rem; color: var(--neon-cyan); border-radius: 8px; cursor: pointer; background: rgba(0, 242, 255, 0.05); margin-bottom: 10px; position: relative; }
        .evidence-dropzone input { position: absolute; width: 100%; height: 100%; top: 0; left: 0; opacity: 0; cursor: pointer; }
        #evidence-preview { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-top: 5px; }
        .evidence-thumb { width: 100%; height: 40px; object-fit: cover; border: 1px solid var(--neon-teal); }
        #notary-badge { padding: 10px; border: 1px solid var(--gold); color: var(--gold); font-size: 0.6rem; font-family: 'Share Tech Mono'; border-radius: 4px; text-align: center; margin-top: 10px; display: none; word-break: break-all; }
        #terminal-log { flex: 1; overflow-y: auto; font-family: 'Share Tech Mono'; font-size: 0.6rem; color: var(--neon-teal); padding: 10px; background: rgba(0,0,0,0.4); border-top: 1px solid var(--panel-border); }
        .log-link { color: var(--neon-pink); text-decoration: underline; cursor: pointer; }
    </style>
</head>
<body>
<div id="boot-screen">
    <div style="font-family: 'Orbitron'; font-size: 1.8rem; letter-spacing: 12px; text-align: center;">TUOLAT LABZ: LADY LEGALZ v4.2.0</div>
    <div class="boot-loader"><div id="progress-bar" class="boot-progress"></div></div>
    <div id="boot-log" style="font-size: 0.7rem; margin-top: 20px; color: var(--neon-cyan); height: 100px; text-align: center;"></div>
</div>
<canvas id="matrix-canvas"></canvas>
<div class="container" id="main-container">
    <div class="header">
        <h1>TUOLAT LABZ || CONTRACTGEN NEO-INTELLIGENCE</h1>
    </div>
    <div class="main-workspace">
        <div class="side-panel">
            <div class="label">DRAFT HISTORY</div>
            <button class="btn" style="background: var(--neon-purple); color: #fff; font-size: 0.55rem;" onclick="saveDraft()">CONTRACTGEN SNAPSHOT</button>
            <div id="history-list"></div>
            <div class="label">CONTRACTGEN PROTOCOLS</div>
            <select onchange="openProtocol(this.value)">
                <option value="">-- SELECT FORM --</option>
                <option value="https://www.uscourts.gov/sites/default/files/js_044.pdf">1. Civil Cover Sheet</option>
                <option value="https://www.uscourts.gov/sites/default/files/complaint_for_a_civil_case.pdf">2. Civil Complaint</option>
                <option value="https://www.uscourts.gov/sites/default/files/ao440.pdf">3. Summons</option>
                <option value="https://www.uscourts.gov/sites/default/files/ao240.pdf">4. IFP Application</option>
                <option value="https://www.uscourts.gov/sites/default/files/ao399.pdf">5. Waiver of Service</option>
                <option value="https://www.uscourts.gov/sites/default/files/ao398.pdf">6. Notice & Request</option>
                <option value="https://www.uscourts.gov/sites/default/files/ao310.pdf">7. Judicial Misconduct</option>
                <option value="https://www.uscourts.gov/sites/default/files/the_defendants_answer_to_the_complaint.pdf">8. Defendant's Answer</option>
                <option value="https://www.uscourts.gov/sites/default/files/complaint_for_violation_of_civil_rights_non-prisoner.pdf">9. Civil Rights (NP)</option>
                <option value="https://www.uscourts.gov/sites/default/files/complaint_for_violation_of_civil_rights_prisoner.pdf">10. Civil Rights (P)</option>
            </select>
            <div class="label">CONTRACTGEN AGREEMENTS</div>
            <select onchange="openProtocol(this.value)">
                <option value="">-- SELECT AGREEMENT --</option>
                <option value="https://www.scc.virginia.gov/media/sccvirginiagov-home/business-home/start-a-new-business/business-types/llc1011.pdf">11. LLC Articles</option>
                <option value="https://flcourts-media.flcourts.gov/content/download/685817/file_pdf/902f2.pdf">12. Divorce Settlement</option>
                <option value="https://willicklawgroup.com/wp-content/uploads/2012/10/TMC0058.pdf">13. Attorney Retainer</option>
                <option value="https://eforms.com/download/2021/03/Georgia-Land-Contract.pdf">14. Land Purchase</option>
                <option value="https://sls.berkeley.edu/wp-content/uploads/2020/09/Form-Auto-Bill-of-Sale.pdf">15. Vehicle Bill of Sale</option>
                <option value="https://www.terma.com/media/0zhbnoox/clickwrap_sla__software_license_agreement_.pdf">16. Software IP License</option>
                <option value="https://eforms.com/images/2019/09/Letter-of-Intent-to-Sue.pdf">17. Intent to Sue</option>
                <option value="https://www.sec.gov/Archives/edgar/data/1409171/000119312510170948/dex101.htm">18. Employment Agreement</option>
                <option value="https://www.nolo.com/files/sample_non_disclosure_agreement.pdf">19. Standard NDA</option>
                <option value="https://www.rocketlawyer.com/preview/lease-agreement.pdf">20. Residential Lease</option>
            </select>
        </div>
        <div class="center-vault">
            <textarea id="scratch" placeholder="Initializing Workspace..."></textarea>
            <iframe id="pdf-frame" title="Legal Protocol Viewer"></iframe>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; background: rgba(0,0,0,0.8);">
                <div>
                    <div class="label" style="margin:0 0 5px 0;">DECLARANT</div>
                    <canvas id="sig-main" class="sig-box" width="400" height="90"></canvas>
                    <button class="btn" style="height: 20px; padding: 0; font-size: 0.5rem;" onclick="clearS(1)">RESET</button>
                </div>
                <div>
                    <div class="label" style="margin:0 0 5px 0;">WITNESS</div>
                    <canvas id="sig-witness" class="sig-box" width="400" height="90"></canvas>
                    <button class="btn" style="height: 20px; padding: 0; font-size: 0.5rem;" onclick="clearS(2)">RESET</button>
                </div>
            </div>
            <button class="btn btn-generate" style="margin: 0; border-radius: 0;" onclick="generatePDF(true)">COMPILED EXPORT</button>
        </div>
        <div class="side-panel">
            <div class="label">ENTITIES</div>
            <input type="text" id="g-plaintiff" placeholder="PLAINTIFF / FIRST PARTY" oninput="syncAll()">
            <input type="text" id="g-defendant" placeholder="DEFENDANT / SECOND PARTY" oninput="syncAll()">
            <input type="text" id="g-case" placeholder="CASE REF / ID">
            <div class="label">EVIDENCE</div>
            <div class="evidence-dropzone">
                [ ATTACH EXHIBITS ]
                <input type="file" multiple accept="image/*" onchange="handleEvidence(this)">
            </div>
            <div id="evidence-preview"></div>
            <div class="label">CONTRACTGEN BETA 3.8.0</div>
            <button class="btn" style="background: var(--gold); color: #000;" onclick="generateNotaryHash()">GENERATE SEAL</button>
            <div id="notary-badge"></div>
            <div class="label">LOG STREAM</div>
            <div id="terminal-log"></div>
            <button class="btn" style="background: transparent; border: 1px solid var(--neon-purple); color: var(--neon-purple); margin-top: 15px;" onclick="togglePreview()">Live TUOLAT LABZ Preview Switch</button>
        </div>
    </div>
</div>
<script>
    const { jsPDF } = window.jspdf || {};
    let evidenceImages = [];
    let sessionHash = "";
    function log(m, url = null) {
        const d = document.createElement('div');
        d.style.marginBottom = "5px";
        d.innerHTML = url ? `> ${m} <span class="log-link" onclick="window.open('${url}', '_blank')">[MANUAL]</span>` : `> ${m}`;
        document.getElementById('terminal-log').prepend(d);
    }
    function openProtocol(url) {
        if(!url) return;
        const frame = document.getElementById('pdf-frame');
        const scratch = document.getElementById('scratch');
        log(`Protocol Accessed: ${url.split('/').pop()}`, url);
        frame.src = url;
        frame.style.display = 'block';
        scratch.style.display = 'none';
    }
    function togglePreview() {
        const f = document.getElementById('pdf-frame');
        const s = document.getElementById('scratch');
        if(f.style.display === 'none') {
            f.src = generatePDF(false);
            f.style.display = 'block'; s.style.display = 'none';
        } else {
            f.style.display = 'none'; s.style.display = 'block';
        }
    }
    function saveDraft() {
        const draft = {
            id: Date.now(),
            p: document.getElementById('g-plaintiff').value,
            d: document.getElementById('g-defendant').value,
            c: document.getElementById('g-case').value,
            t: document.getElementById('scratch').value,
            h: sessionHash,
            date: new Date().toLocaleString()
        };
        let history = JSON.parse(localStorage.getItem('legalz_v4_history') || '[]');
        history.unshift(draft);
        localStorage.setItem('legalz_v4_history', JSON.stringify(history.slice(0, 10)));
        renderHistory();
        log("Local Memory Committed.");
    }
    function renderHistory() {
        const list = document.getElementById('history-list');
        const history = JSON.parse(localStorage.getItem('legalz_v4_history') || '[]');
        list.innerHTML = history.map(h => `
            <div class="history-item" onclick="loadDraft(${h.id})">
                <div class="date">${h.date}</div>
                <div>${h.p || 'Untitled'} vs ${h.d || '...'}</div>
            </div>
        `).join('');
    }
    function loadDraft(id) {
        const history = JSON.parse(localStorage.getItem('legalz_v4_history') || '[]');
        const d = history.find(x => x.id === id);
        if(d) {
            document.getElementById('g-plaintiff').value = d.p;
            document.getElementById('g-defendant').value = d.d;
            document.getElementById('g-case').value = d.c;
            document.getElementById('scratch').value = d.t;
            sessionHash = d.h;
            log("State Restored.");
            syncAll();
        }
    }
    function generateNotaryHash() {
        sessionHash = "LADY-SEC-" + Math.random().toString(36).substring(2, 10).toUpperCase();
        const badge = document.getElementById('notary-badge');
        badge.style.display = badge.innerHTML = `NEURAL SEAL ACTIVE: ${sessionHash}`;
        badge.style.display = 'block';
        log("Seal Generated.");
    }
    const setupSig = (id) => {
        const c = document.getElementById(id);
        const ctx = c.getContext('2d');
        let draw = false;
        const getPos = (e) => {
            const rect = c.getBoundingClientRect();
            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;
            return { x: (cx - rect.left) * (c.width / rect.width), y: (cy - rect.top) * (c.height / rect.height) };
        };
        c.addEventListener('mousedown', (e) => { draw = true; ctx.beginPath(); const p = getPos(e); ctx.moveTo(p.x, p.y); });
        c.addEventListener('mousemove', (e) => { if(draw) { const p = getPos(e); ctx.lineTo(p.x, p.y); ctx.stroke(); }});
        window.addEventListener('mouseup', () => draw = false);
        ctx.strokeStyle = '#000'; ctx.lineWidth = 2; return ctx;
    };
    setupSig('sig-main'); setupSig('sig-witness');
    function clearS(n) {
        const c = document.getElementById(n === 1 ? 'sig-main' : 'sig-witness');
        c.getContext('2d').clearRect(0,0,c.width,c.height);
    }
    function handleEvidence(input) {
        Array.from(input.files).forEach(file => {
            const reader = new FileReader();
            reader.onload = (e) => {
                evidenceImages.push(e.target.result);
                const img = document.createElement('img');
                img.src = e.target.result; img.className = 'evidence-thumb';
                document.getElementById('evidence-preview').appendChild(img);
            };
            reader.readAsDataURL(file);
        });
    }
    function generatePDF(download = false) {
        const doc = new jsPDF();
        const p = document.getElementById('g-plaintiff').value || "EMPTY";
        const d = document.getElementById('g-defendant').value || "EMPTY";
        const c = document.getElementById('g-case').value || "NONE";
        const txt = document.getElementById('scratch').value || "NO DATA RECORDED";
        doc.setFillColor(1, 5, 8);
        doc.rect(0, 0, 210, 40, 'F');
        doc.setTextColor(0, 255, 157);
        doc.setFont("courier", "bold");
        doc.setFontSize(18);
        doc.text("LADY LEGALZ // CONTRACTGEN OUTPUT", 105, 20, { align: "center" });
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(8);
        doc.text(`SESSION ID: ${Date.now()} | SEAL: ${sessionHash || 'UNVERIFIED'}`, 105, 30, { align: "center" });
        doc.setTextColor(0,0,0);
        doc.setFontSize(10);
        doc.setFont("courier", "normal");
        let y = 50;
        doc.text(`CASE REF: ${c}`, 20, y);
        y += 10;
        doc.text(`PARTIES: ${p} vs ${d}`, 20, y);
        y += 20;
        const txtLines = doc.splitTextToSize(txt, 170);
        for (let line of txtLines) {
            if (y > 270) {
                doc.addPage();
                y = 20;
            }
            doc.text(line, 20, y);
            y += 5;
        }
        y += 10;
        if (y > 250) {
            doc.addPage();
            y = 20;
        }
        doc.text("DECLARANT:", 20, y);
        y += 5;
        const sigMain = document.getElementById('sig-main').toDataURL('image/png');
        doc.addImage(sigMain, 'PNG', 20, y, 80, 18);
        y += 25;
        if (y > 250) {
            doc.addPage();
            y = 20;
        }
        doc.text("WITNESS:", 20, y);
        y += 5;
        const sigWitness = document.getElementById('sig-witness').toDataURL('image/png');
        doc.addImage(sigWitness, 'PNG', 20, y, 80, 18);
        y += 25;
        if (evidenceImages.length > 0) {
            if (y > 250) {
                doc.addPage();
                y = 20;
            }
            doc.text("EXHIBITS:", 20, y);
            y += 10;
            for (let i = 0; i < evidenceImages.length; i++) {
                if (y > 200) {
                    doc.addPage();
                    y = 20;
                }
                doc.text(`Exhibit ${i+1}:`, 20, y);
                y += 5;
                const imgData = evidenceImages[i];
                const format = imgData.split(';')[0].split('/')[1].toUpperCase();
                doc.addImage(imgData, format, 20, y, 170, 120);
                y += 130;
            }
        }
        if(download) doc.save("LLCONTRACTGEN_EXPORT.pdf");
        return doc.output('bloburl');
    }
    function runBoot() {
        const logEl = document.getElementById('boot-log');
        const msgs = ["WAKING NEURAL ENGINE...", "LOAD PROTOCOLS CONTRACTGEN v3.8.0", "SECURITY TUOLAT LABZ... OK", "LADY LEGALZ BETA 4 READY."];
        let i = 0;
        const iv = setInterval(() => {
            if(i < msgs.length) {
                logEl.innerHTML += `> ${msgs[i]}<br>`;
                document.getElementById('progress-bar').style.width = ((i+1)/msgs.length)*100 + "%";
                i++;
            } else {
                clearInterval(iv);
                setTimeout(() => { document.getElementById('boot-screen').style.display = 'none'; renderHistory(); }, 500);
            }
        }, 300);
    }
    runBoot();
    const canv = document.getElementById('matrix-canvas');
    const ctxM = canv.getContext('2d');
    canv.width = window.innerWidth; canv.height = window.innerHeight;
    const drops = Array(Math.floor(canv.width/20)).fill(1);
    function drawM() {
        ctxM.fillStyle = "rgba(0,0,0,0.05)"; ctxM.fillRect(0,0,canv.width,canv.height);
        ctxM.fillStyle = "#00ff9d"; ctxM.font = "15px monospace";
        drops.forEach((y, i) => {
            ctxM.fillText(Math.random() > 0.5 ? "1" : "0", i*20, y*20);
            if(y*20 > canv.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        });
    }
    setInterval(drawM, 50);
    function syncAll() {
        const val = (document.getElementById('g-plaintiff').value + document.getElementById('g-defendant').value).toLowerCase();
        document.getElementById('main-container').classList.toggle('neural-alert', val.includes('sue') || val.includes('court'));
    }
</script>
</body>
</html>
